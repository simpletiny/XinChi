<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib uri="/struts-tags" prefix="s" %> 
<%
	String path = request.getContextPath();
	String basePath = request.getScheme() + "://"
			+ request.getServerName() + ":" + request.getServerPort()
			+ path + "/";
%>
<html>
<head>
<link rel="stylesheet" type="text/css" href="common/css/leftmenu.css" />
	<script type="text/javascript">
		$(document).ready(function(){
			var left_bodyWidth = $("body").width();
			var left_transheight = $(document.body).outerHeight(true);
			var left_loginWidth = $("#tanchu_res").width();
			var num = (left_bodyWidth-(left_loginWidth))/2;
			/* $("#tanchu_res").hide();
			$(".transparent_res").hide(); */
			$("#resname").click(function(){
				$(".transparent_res").show();
				$(".transparent_res").css("width", left_bodyWidth);
				$(".transparent_res").css("height",left_transheight);
				$("#tanchu_res").css("left",num);
				$("#tanchu_res").css("top","110px");
				$("#tanchu_res").show();
			});
			$("#btnclose").click(function(){
				$("#tanchu_res").hide();
				$(".transparent_res").hide();
			})
			$("#btn_sub").click(function(){
				$("#tanchu_res").hide();
				$(".transparent_res").hide();
				if(!validateResForm()){
					   return;
				}else{	   
					var action = $("#resform").attr("action");
				  $.ajax({
				        url: action,
				        data: $("#resform").serialize(),
				        type: "post",
				        dataType: "json",
				        success: function(data){
				        	 alert("保存成功！");
				        	 $("#res_name_text").text($("#res_name").val());
				        }
					}); 
				}
			})
		})
		function validateResForm(){
			var resname = $("#res_name").val();
			if(resname && resname != null && resname.length > 0){
				return true;
			}else{
				return false;
			}
		}
		function resumeReview() {
			window
					.open("<%=basePath%>person/resumeReview", 'newwindow',
							'width=800,height=700,top=100,left=200,toolbar=no,menubar=no,scrollbars=yes,resizable=no,location=no,status=no');
		}
	</script>
</head>
<body>
	<div class="transparent_res"></div>
	<div id="tanchu_res">
    	<h4>
        	<a id="btnclose" href="javascript:void" class="close"></a>
        </h4>
        <div class="tanchu_inner_res">
        	<form id="resform" action="<%=basePath %>person/updateResume" method="post">
        		<input type="hidden" name="resume.id" value="${session.LOGIN_SESSION_BEAN.res_id }" />
	    	<p>
	    		简历名称：<input id="res_name" name="resume.name" style="width: 142px; height: 33px; line-height: 33px; background: url(common/images/big_input.jpg) repeat-x; margin-right: 10px; text-align: center; font-size: 16px;" type="text" value="${session.LOGIN_SESSION_BEAN.res_name }"/>
			</p>
	    	<p style="text-align: center;">
				<input id="btn_sub" type="button" style="width:150px;height:60px;" value="修改" />
			</p>
			</form>
        </div>
    </div>
	<div class="nav">
		<div class="big_pic">
			<h4></h4>
			<p id="res_name_text">${session.LOGIN_SESSION_BEAN.res_name }</p>
			<p>
				<a  id="resname" href="javascript:void" >修改名称</a><a href="javascript:location.reload();">刷新</a><a href="javascript:resumeReview()" >预览</a>
			</p>
		</div>
		<ul class="nav_inner">
			<li style="height: 43px; background: url(common/images/leftmenu/jl_head.jpg);"></li>
				<s:iterator id="menu" value="leftmenus">
					<li 
					<c:if test="${menu.tab_name == lm_tab_name}">
						class="bjs"
					</c:if>
					><a style="background: url(common/images/leftmenu/${menu.class_name}.png) 19px center no-repeat" href="${menu.path }">${menu.title }</a> <img
					src="common/images/leftmenu/prev.png" class="prev" /></li>
				</s:iterator>
			<img src="common/images/leftmenu/tlsm_m.jpg" >
		</ul>
	</div>
</body>
</html>
