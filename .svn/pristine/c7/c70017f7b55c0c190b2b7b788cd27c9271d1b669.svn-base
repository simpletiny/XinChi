$(document).ready(function() {
	$('#btn_save').click(function() {
		saveInfo();
	});
	$('#btn_cancel').click(function() {
		cancelSave();
	});
	if ($("#logo_name").val() != "") {
		$("#img_logo").attr("src", window['basePath'] + $("#logo_name").val());
	}

	if ($("#IndustryID_2").val() != "") {
		$("#btn_IndustryID_2").val(ind_a[$("#IndustryID_2").val()]);
	}
});
/**
 * 验证表单
 * 
 * @returns {Boolean}
 */
function validate_form() {
	if ($.trim($("#txt_ent_name").val()) == "") {
		alert("公司名称不能为空!");
		return false;
	}
	if ($("#IndustryID_2").val() == "") {
		alert("全选择所属行业!");
		return false;
	}
	if ($("#size_id").val() == "0" || $("#size_id").val() == "") {
		alert("请选择公司规模!");
		return false;
	}
	if ($.trim($("#txt_com_address").val()) == "") {
		alert("请填写公司地址!");
		return false;
	}

	if ($.trim($("#txt_com_phone").val()) == "") {
		alert("请填写联系方式!");
		return false;
	}
	return true;
}
/**
 * 保存公司信息
 */
function saveInfo() {
	if (!validate_form())
		return;
	var param = $("#form_edit").serialize();
	var layIndex = layer.load('保存中...', 0);
	$.ajax({
		url : 'saveEdit',
		type : 'post',
		data : param,
		success : function(r) {
			var data = eval(r);
			if (data.result == "OK") {
				layer.close(layIndex);
				alert("保存成功");
				location.href = "companyInfoInit";
			}
		},
		error : function(data) {
			alert("操作失败，请稍后重试！");
		}
	});
}
/**
 * 取消保存
 */
function cancelSave() {
	if (confirm("确定要取消编辑的信息吗？")) {
		history.go(-1);
	}
}
function hide(id) {
	$(id).is(":visible") ? $(id).hide() : $(id).show();
}
/**
 * 选择公司规模
 * 
 * @param v
 * @param span
 */
function pickSize(v, span) {

	$("#am").val($(span).html());
	$("#size_id").val(v);
	hide('#HMF-1');
}

function logoupload() {
	var ele = document.getElementById("hidBtn");
	ele.click();
}

function upload2() {
	$("#form_edit").ajaxSubmit({
		type : 'post',
		url : "entLogoUpload",
		dataType : "json",
		success : function(data) {
			if (data.error) {
				alert("上传文件大小超过限制！");
			} else {
				$("#img_logo").attr("src", window['basePath'] + data.path);
				$("#logo_name").val(data.path);
			}
		},
		error : function(XmlHttpRequest, textStatus, errorThrown) {
			alert("上传失败，请重新上传！");
		}
	});
}