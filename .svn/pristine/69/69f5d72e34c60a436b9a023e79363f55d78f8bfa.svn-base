package seentao.xhsn.tools;

import java.io.File;
import java.io.FileOutputStream;
import java.io.OutputStream;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;

import jxl.Workbook;
import jxl.write.Label;
import jxl.write.WritableSheet;
import jxl.write.WritableWorkbook;

/**
 * excel操作公用类
 * 
 * @author niushixing 2015-1-15 14:41:09
 *
 */
public class ExcelUtil {
	// private static WritableWorkbook book;
	//
	// static {
	// try {
	// book = Workbook.createWorkbook(new File("D://test.xlsx"));
	// } catch (IOException e) {
	// e.printStackTrace();
	// }
	// }
	/**
	 * 按行写数据
	 * 
	 * @param data
	 *            map<行号，数据>
	 * @param templet
	 * @param dest
	 * @throws Exception
	 */
	public static void writeDataRowByRow(Map<Integer, List<Object>> data, String templet, OutputStream os)
			throws Exception {
		Workbook book = Workbook.getWorkbook(new File(templet));
		WritableWorkbook result = Workbook.createWorkbook(os, book);
		WritableSheet sheet = result.getSheet(0);
		if (data != null) {
			Iterator<Integer> iter = data.keySet().iterator();
			while (iter.hasNext()) {
				int row = iter.next();
				List<Object> rowList = data.get(row);
				for (int i = 0; i < rowList.size(); i++) {
					String content = rowList.get(i).toString();
					Label label = new Label(i, row, content);
					sheet.addCell(label);
				}
			}
		}
		result.write();
		book.close();
		result.close();
	}

	public static void main(String[] arg) throws Exception {
		Map<Integer, List<Object>> data = new HashMap<Integer, List<Object>>();
		for (int i = 0; i < 10; i++) {
			List<Object> rowList = new ArrayList<Object>();
			for (int j = 0; j < 10; j++) {
				rowList.add(i * j + "");
			}
			data.put(i + 1, rowList);
		}
		ExcelUtil.writeDataRowByRow(data, null, new FileOutputStream(new File("D://test//niu.xls")));
	}
}
