$(document).ready(function() {
	$('#btn_save').click(function() {
		saveInfo();
	});
	$('#btn_cancel').click(function() {
		cancelSave();
	});
	if ($("#logo_name").val() != "") {
		$("#img_logo").attr("src", "/filesys/" + $("#logo_name").val());
	}
	
	CKEDITOR.replace( 'txt_com_info' ,{
		toolbar :
            [
//加粗     斜体，     下划线      穿过线      下标字        上标字
               ['Bold','Italic','Underline','Strike','Subscript','Superscript'],
//数字列表          实体列表            减小缩进    增大缩进
               ['NumberedList','BulletedList','-','Outdent','Indent'],
//左对齐             居中对齐          右对齐          两端对齐
               ['JustifyLeft','JustifyCenter','JustifyRight','JustifyBlock'],
//超链接  取消超链接 锚点
               /* ['Link','Unlink','Anchor'], */
//图片    flash    表格       水平线            表情       特殊字符        分页符
               /* ['Image','Flash','Table','HorizontalRule','Smiley','SpecialChar','PageBreak'],*/ 
'/',
//样式       格式      字体    字体大小
               ['Styles','Format','Font','FontSize'],
//文本颜色     背景颜色
               ['TextColor','BGColor'],
//全屏           显示区块
               ['Maximize', 'ShowBlocks','-']
            ]
	});
});
/**
 * 验证表单
 * 
 * @returns {Boolean}
 */
function validate_form() {
	if ($.trim($("#txt_ent_name").val()) == "") {
		alert("公司名称不能为空!");
		return false;
	}
	if ($("#IndustryID_2").val() == "") {
		alert("全选择所属行业!");
		return false;
	}
	if ($("#size_id").val() == "0" || $("#size_id").val() == "") {
		alert("请选择公司规模!");
		return false;
	}
	if ($.trim($("#txt_com_address").val()) == "") {
		alert("请填写公司地址!");
		return false;
	}

	if ($.trim($("#txt_telephone").val()) == "") {
		alert("电话不能为空!");
		return false;
	}
	if ($.trim($("#txt_tele_area_code").val()) == "") {
		alert("电话区号不能为空!");
		return false;
	}
	return true;
}
/**
 * 保存公司信息
 */
function saveInfo() {
	if (!validate_form())
		return;
	var param = $("#form_edit").serialize();
	var layIndex = layer.load('保存中...', 0);
	$.ajax({
		url : 'saveEdit',
		type : 'post',
		data : param,
		success : function(r) {
			var data = eval(r);
			if (data.result == "OK") {
				layer.close(layIndex);
				alert("保存成功");
				location.href = "companyInfoInit";
			}
		},
		error : function(data) {
			alert("操作失败，请稍后重试！");
		}
	});
}
/**
 * 取消保存
 */
function cancelSave() {
	if (confirm("确定要取消编辑的信息吗？")) {
		history.go(-1);
	}
}
function hide(id) {
	$(id).is(":visible") ? $(id).hide() : $(id).show();
}
/**
 * 选择公司规模
 * 
 * @param v
 * @param span
 */
function pickSize(v, span) {

	$("#am").val($(span).html());
	$("#size_id").val(v);
	hide('#HMF-1');
}

function logoupload() {
	var ele = document.getElementById("hidBtn");
	ele.click();
}

function upload2() {
	$("#form_edit").ajaxSubmit({
		type : 'post',
		url : "entLogoUpload",
		dataType : "json",
		success : function(data) {
			if (data.error) {
				alert("上传文件大小超过限制！");
			} else {
				$("#img_logo").attr("src", "/filesys/" + data.path);
				$("#logo_name").val(data.path);
			}
		},
		error : function(XmlHttpRequest, textStatus, errorThrown) {
			alert("上传失败，请重新上传！");
		}
	});
}
/**
 * 只能是数字的约束
 * 
 * @param e
 * @returns
 */
function onlynumber(e) {
	var keynum;
	var keychar;
	var numcheck;

	if (window.event) {
		keynum = e.keyCode;
	} else if (e.which) {
		keynum = e.which;
	}
	// 屏蔽删除键
	if (keynum == 8 || keynum == 46) {
		return true;
	}
	// 屏蔽复制剪切粘贴快捷键
	if ((e.ctrlKey && keynum == 67) || (e.ctrlKey && keynum == 86)
			|| (e.ctrlKey && keynum == 88)) {
		return true;
	}
	keychar = String.fromCharCode(keynum);
	numcheck = /\d/;
	return numcheck.test(keychar);
}