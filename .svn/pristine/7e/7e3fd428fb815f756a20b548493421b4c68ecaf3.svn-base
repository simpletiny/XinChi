<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@taglib uri="/struts-tags" prefix="s" %> 
<%
String path = request.getContextPath();
String basePath = request.getScheme()+"://"+request.getServerName()+":"+request.getServerPort()+path+"/";
%>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>新道人才网</title>
<link rel="stylesheet" type="text/css" href="<%=basePath %>common/css/basic.css"  />
<link rel="stylesheet" type="text/css" href="<%=basePath %>person/jobDetail/css/job_detail.css"  />
<script src="<%=basePath %>common/js/jquery-1.8.1.min.js" type="text/javascript"></script>
<script src="<%=basePath %>common/js/city_arr.js" type="text/javascript"></script>
<script src="<%=basePath %>common/js/funtype_arr.js" type="text/javascript"></script>
<script type="text/javascript">
	
	$(document).ready(function() {
		var jobAddr = $("#span_job_addr").html();
		var addrs = jobAddr.split(",");
		var jobAddr = "";
		for(var i=0;i<addrs.length;i++){
			jobAddr +=","+ ja[addrs[i]];
		}
		$("#span_job_addr").html(jobAddr.substring(1));
		
		var jobType = $("#span_job_type").html();
		jobType = fun_a[jobType];
		$("#span_job_type").html(jobType);
		
		$('.introduction').hide();
		$('.introduction_b,.requirement_b').removeClass('active');
		$('.requirement_b').addClass('active');
		$('.introduction_b').click(function() {
			$('.introduction_b,.requirement_b').removeClass('active');
			$(this).addClass('active')
			$('.introduction,.requirement').hide();
			$('.introduction').show();
		});

		$('.requirement_b').click(function() {
			$('.introduction_b,.requirement_b').removeClass('active');
			$(this).addClass('active')
			$('.introduction,.requirement').hide();
			$('.requirement').show();
		});

		var bodyWidth = $("body").width();
		var transheight = $(document.body).outerHeight(true);

		var loginWidth = $("#tanchu").width();

		var num = (bodyWidth - (loginWidth)) / 2;

		$("#tanchu").hide();
		$(".transparent").hide();
		$(".dianji").click(function() {
			$(".transparent").show();
			$(".transparent").css("width", bodyWidth);
			$(".transparent").css("height", transheight);
			$("#tanchu").css("left", num);
			$("#tanchu").css("top", "110px");
			$("#tanchu").show();
		});
		$(".close").click(function() {
			$("#tanchu").hide();
			$(".transparent").hide();
		})
	})

	//申请职位
	function putresume() {
		//1、获取已选中的

		var res_id = $("#txt_res_id").val();
		var job_id = $("#job_id").val();
		if(res_id==""){
			alert("请选择要发送的简历!");
			return;
		}
		/* $.get("applyJob?job_ids="+job_id+"&res_id="+res_id,function(r){
			if(r=="OK"){
				alert("申请成功");
				$("#tanchu").hide();
				$(".transparent").hide();
			}
		}); */
		if(job_id != "" && res_id != ""){
			$("#res_id_form").val(res_id);
			$("#job_id_form").val(job_id);
			document.getElementById("putform").action = "putresume";
			document.getElementById("putform").submit();
		}
		
	}
	function pickResume(span) {
		$("#txt_resume").val($(span).html());
		$("#txt_res_id").val($($(span).prev("input:first")).val());
		$("#div_resume").hide();

	}
	function hide(div) {
		$(div).is(":visible") ? $(div).hide() : $(div).show();
	}
</script>
</head>

<body>
    <div class="transparent"></div>
    <div id="tanchu" style="display:none">
    	<h4>
        	<a href="javascript:void(0)" class="close"></a>
        </h4>
        <div class="tanchu_inner">
        	<p>请选择简历：</p>
            <div style="position:relative;">
            	<input type="hidden" id="txt_res_id" />
            	<input onclick="hide('#div_resume')" name="" value="" type="text" style="background:url(<%=basePath %>common/images/select.jpg) no-repeat;width:193px; padding-left:5px;height:35px; line-height:35px; border:none;cursor:pointer; font-size:14px;" id="txt_resume" class="am"/>
                <div id="div_resume" style="display: none; position:absolute; left:0px; top:35px; width:196px; background:#FFF; " class="bm">
                	<s:hidden value="%{#session.LOGIN_SESSION_BEAN.res_id}"/>
 					<span id="a1" onclick="pickResume(this)" onMouseOver="bgcolor('a1')" onMouseOut="nocolor('a1')" class="cur"><s:property value="#session.LOGIN_SESSION_BEAN.res_name"/></span>  	
                </div>
            </div>
            <a href="javascript:putresume()"  style="display:block; width:190px; height:46px; line-height:48px; text-align:center; background:#fea201; font-size:16px; border-bottom:2px solid #c9b387; margin-left:145px; margin-top:30px;">立即申请</a>
          </div>
    </div>
	<div id="wrap">
    	<jsp:include page="../../common/page/head_person.jsp" />
      <div id="search">
      	<div class="search_inner">
        	<h2><s:property value="jobDetail.jobName"/></h2>
            <p><s:property value="jobDetail.companyName"/></p>
            <a href="javascript:void(0)" class="dianji" style="color:white">立即申请</a>
        </div>
      </div>
      <div id="main">
      	<div class="main_inner">
      		<s:hidden id="job_id" value="%{jobDetail.id }"></s:hidden>
        	<table width="700" cellspacing="0px"  style="border-collapse:collapse; border:0; font-size:12px; color:#565555;">
            <tr>
            	<td width="340" height="45">职位月薪：<s:property value="jobDetail.monthlyPay"/></td>
            	<td width="360">工作地点：<span id="span_job_addr"><s:property value="jobDetail.jobAddress"/></span></td>
            </tr>
            <tr>
            	<td width="340" height="45">发布日期：<s:property value="jobDetail.publishDate"/></td>
            	<td width="360">工作性质：
            	<s:if test='jobDetail.jobProperty=="0"'>
            		全职
            	</s:if>
            	<s:elseif test='jobDetail.jobProperty=="1"'>
            		兼职
            	</s:elseif>
            	<s:else>
            		实习
            	</s:else>
            </td>
            </tr>
            <tr>
            	<td width="340" height="45">工作经验：<s:property value="jobDetail.jobExp"/></td>
            	<td width="360">最低学历：<s:property value="jobDetail.jobEducation"/></td>
            </tr>
            <tr>
            	<td width="340" height="45">招聘人数：<s:property value="jobDetail.needCnt"/></td>
            	<td width="360">职位类别：<span id="span_job_type"><s:property value="jobDetail.jobType"/></span></td>
            </tr>
            </table>
            <ul class="qh">
            	<li><a href="javascript:void(0)"  class="requirement_b">职位描述</a></li>
            	<li><a href="javascript:void(0)" class="introduction_b">公司介绍</a></li>
                <br />
            </ul>
            <div class="info_box">
            	<div class="requirement">
                	<dl>
                   	  <dt>岗位职责：</dt>
                      <p>${jobDetail.jobDuty }</p>
                    </dl>
                </div>
            	<div class="introduction">
                <dl>
                   	  <dt>公司简介：</dt>
                   	  <s:property value="jobDetail.companySummary"/>
                </div>
            </div>
              <a href="javascript:void(0)" style="display:block; width:190px; height:46px; line-height:48px; text-align:center; background:#fea201; font-size:16px; border-bottom:2px solid #c9b387; position:absolute; bottom:20px;color:white"  class="dianji">立即申请</a>
        </div>
      </div>
      <s:include value="../../common/page/footer.jsp"></s:include>
    </div>
    	<form action="" method="post" name="putform" id="putform">
            	<input type="hidden" id="res_id_form" name="res_id" value="" />
            	<input type="hidden" id="job_id_form" name="job_id" value="" />
            </form>
</body>
</html>
